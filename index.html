<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade Calculator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@72,600;72,700;72,800&family=Nunito:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Colors - Earth Tones */
            --bg: #FDFCF8;
            --fg: #2C2C24;
            --primary: #5D7052;
            --primary-fg: #F3F4F1;
            --secondary: #C18C5D;
            --secondary-fg: #FFFFFF;
            --accent: #E6DCCD;
            --accent-fg: #4A4A40;
            --muted: #F0EBE5;
            --muted-fg: #78786C;
            --border: #DED8CF;
            --destructive: #A85448;
            
            /* Typography */
            --font-serif: 'Fraunces', serif;
            --font-sans: 'Nunito', sans-serif;
            
            /* Shadows */
            --shadow-soft: 0 4px 20px -2px rgba(93, 112, 82, 0.15);
            --shadow-float: 0 10px 40px -10px rgba(193, 140, 93, 0.2);
            --shadow-deep: 0 20px 40px -10px rgba(93, 112, 82, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-sans);
            background: var(--bg);
            color: var(--fg);
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }

        /* Texture Overlay */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml,%3Csvg viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg"%3E%3Cfilter id="noiseFilter"%3E%3CfeTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="4" result="noise"/%3E%3C/filter%3E%3Crect width="400" height="400" filter="url(%23noiseFilter)" opacity="0.03"/%3E%3C/svg%3E');
            pointer-events: none;
            mix-blend-mode: multiply;
            z-index: 1;
        }

        .container {
            position: relative;
            z-index: 2;
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg);
            border-radius: 40px;
            box-shadow: var(--shadow-soft);
            overflow: hidden;
            border: 1px solid rgba(222, 216, 207, 0.4);
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: var(--primary-fg);
            padding: 60px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        /* Organic blobs in header */
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 400px;
            height: 400px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
            filter: blur(40px);
            z-index: 0;
        }

        .header::after {
            content: '';
            position: absolute;
            bottom: -30%;
            left: -5%;
            width: 300px;
            height: 300px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
            filter: blur(40px);
            z-index: 0;
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .header h1 {
            font-family: var(--font-serif);
            font-size: clamp(2em, 6vw, 3.5em);
            font-weight: 800;
            margin-bottom: 12px;
            letter-spacing: -1px;
            color: var(--primary-fg);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header p {
            font-size: clamp(0.95em, 2vw, 1.2em);
            opacity: 0.95;
            font-weight: 500;
        }

        .controls {
            display: flex;
            gap: 12px;
            padding: 28px;
            background: rgba(240, 235, 229, 0.5);
            justify-content: center;
            flex-wrap: wrap;
            border-top: 1px solid rgba(222, 216, 207, 0.3);
        }

        /* Button Styles */
        button {
            padding: 12px 28px;
            background: var(--primary);
            color: var(--primary-fg);
            border: 2px solid var(--primary);
            border-radius: 50px;
            cursor: pointer;
            font-family: var(--font-sans);
            font-size: 0.95em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-soft);
            white-space: nowrap;
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 24px -4px rgba(93, 112, 82, 0.25);
            background: var(--primary);
        }

        button:active {
            transform: scale(0.95);
        }

        button:focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        .tab-container {
            display: flex;
            gap: 12px;
            padding: 20px;
            background: linear-gradient(to right, rgba(93, 112, 82, 0.02), rgba(193, 140, 93, 0.02));
            border-top: 1px solid rgba(222, 216, 207, 0.3);
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-button {
            padding: 12px 28px;
            background: rgba(255, 255, 255, 0.7);
            border: 2px solid var(--border);
            border-radius: 50px;
            color: var(--muted-fg);
            cursor: pointer;
            font-family: var(--font-sans);
            font-size: 0.95em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .tab-button:hover {
            background: white;
            border-color: var(--primary);
            color: var(--primary);
            transform: none;
            box-shadow: none;
        }

        .tab-button.active {
            background: var(--primary);
            color: var(--primary-fg);
            border-color: var(--primary);
            box-shadow: var(--shadow-soft);
        }

        .tab-button:focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        .tab-content {
            display: none;
            padding: 40px;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        .tab-content h2 {
            font-family: var(--font-serif);
            font-size: clamp(1.8em, 4vw, 2.5em);
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--fg);
        }

        .tab-content > p {
            color: var(--muted-fg);
            margin-bottom: 32px;
            font-size: 1em;
            line-height: 1.6;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .form-group {
            margin-bottom: 28px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: var(--fg);
            font-weight: 600;
            font-size: 0.95em;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 14px 20px;
            border: 2px solid var(--border);
            border-radius: 50px;
            font-family: var(--font-sans);
            font-size: 1em;
            background: rgba(255, 255, 255, 0.6);
            color: var(--fg);
            transition: all 0.3s ease;
        }

        .form-group input::placeholder,
        .form-group select {
            color: var(--muted-fg);
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 3px rgba(93, 112, 82, 0.1);
        }

        .grade-entry-table {
            width: 100%;
            border-collapse: collapse;
            margin: 28px 0;
            overflow: hidden;
            border-radius: 28px;
            box-shadow: var(--shadow-soft);
            border: 1px solid rgba(222, 216, 207, 0.4);
            background: white;
        }

        .grade-entry-table th {
            background: linear-gradient(135deg, rgba(93, 112, 82, 0.8) 0%, rgba(193, 140, 93, 0.7) 100%);
            color: var(--primary-fg);
            padding: 18px 20px;
            text-align: left;
            font-weight: 600;
            font-size: 0.95em;
        }

        .grade-entry-table td {
            padding: 16px 20px;
            border-bottom: 1px solid rgba(222, 216, 207, 0.3);
        }

        .grade-entry-table tr:last-child td {
            border-bottom: none;
        }

        .grade-entry-table tr:hover {
            background: rgba(93, 112, 82, 0.02);
        }

        .grade-entry-table input {
            width: 100%;
            padding: 10px 14px;
            border: 2px solid var(--border);
            border-radius: 24px;
            font-family: var(--font-sans);
            font-size: 0.95em;
            background: rgba(255, 255, 255, 0.8);
            color: var(--fg);
            transition: all 0.3s ease;
        }

        .grade-entry-table input:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 3px rgba(93, 112, 82, 0.1);
        }

        .grade-entry-table button {
            padding: 8px 16px;
            background: var(--destructive);
            color: white;
            border: 2px solid var(--destructive);
            border-radius: 24px;
            cursor: pointer;
            font-family: var(--font-sans);
            font-size: 0.85em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-soft);
        }

        .grade-entry-table button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 24px -4px rgba(168, 84, 72, 0.25);
        }

        .grade-entry-table button:active {
            transform: scale(0.95);
        }

        .add-row-btn {
            background: var(--secondary);
            border-color: var(--secondary);
            margin-bottom: 15px;
            padding: 12px 28px;
            font-size: 0.95em;
        }

        .add-row-btn:hover {
            box-shadow: 0 6px 24px -4px rgba(193, 140, 93, 0.25);
        }

        .results {
            background: linear-gradient(135deg, rgba(93, 112, 82, 0.05) 0%, rgba(193, 140, 93, 0.05) 100%);
            padding: 28px;
            border-radius: 28px;
            margin-top: 28px;
            border-left: 4px solid var(--primary);
            border: 1px solid rgba(222, 216, 207, 0.4);
            box-shadow: var(--shadow-soft);
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 16px 0;
            font-size: 1.05em;
            gap: 20px;
        }

        .result-label {
            font-weight: 600;
            color: var(--fg);
            flex-shrink: 0;
        }

        .result-value {
            font-size: 1.35em;
            color: var(--primary);
            font-weight: 700;
            font-family: var(--font-sans);
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            body {
                padding: 12px;
            }

            .container {
                border-radius: 28px;
            }

            .header {
                padding: 40px 24px;
                border-radius: 28px 28px 0 0;
            }

            .header h1 {
                font-size: 2em;
                margin-bottom: 8px;
            }

            .header p {
                font-size: 0.95em;
            }

            .controls {
                flex-direction: column;
                padding: 16px;
                gap: 10px;
            }

            .controls button {
                width: 100%;
                padding: 14px 20px;
            }

            .tab-container {
                flex-direction: column;
                gap: 10px;
                padding: 16px;
            }

            .tab-button {
                width: 100%;
                padding: 12px 20px;
            }

            .tab-content {
                padding: 28px 20px;
            }

            .tab-content h2 {
                font-size: 1.6em;
                margin-bottom: 8px;
            }

            .tab-content > p {
                margin-bottom: 24px;
            }

            .form-group {
                margin-bottom: 20px;
            }

            .form-group label {
                font-size: 0.9em;
                margin-bottom: 8px;
            }

            .grid-2 {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .grade-entry-table {
                font-size: 0.85em;
                margin: 20px 0;
            }

            .grade-entry-table th {
                padding: 12px 12px;
            }

            .grade-entry-table td {
                padding: 12px 8px;
            }

            .grade-entry-table input {
                padding: 8px 10px;
                font-size: 0.9em;
            }

            .grade-entry-table button {
                padding: 6px 12px;
                font-size: 0.8em;
            }

            .add-row-btn {
                width: 100%;
                margin-bottom: 16px;
            }

            .result-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .result-label {
                font-size: 0.95em;
            }

            .result-value {
                font-size: 1.2em;
            }

            .results {
                padding: 20px 16px;
                margin-top: 20px;
            }

            .calculation-note {
                padding: 16px;
                font-size: 0.9em;
                margin-top: 20px;
            }

            .modal-content {
                width: 90%;
                max-width: 90%;
                margin: 50% auto;
                padding: 28px;
                border-radius: 28px;
            }

            .modal-header {
                font-size: 1.4em;
                margin-bottom: 16px;
            }

            .modal-buttons {
                flex-direction: column-reverse;
                gap: 10px;
            }

            .modal-buttons button {
                width: 100%;
                padding: 12px 20px;
            }

            .save-list li {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
                padding: 12px 16px;
            }

            .save-buttons {
                width: 100%;
                gap: 8px;
            }

            .save-buttons button {
                flex: 1;
                padding: 10px 12px;
                font-size: 0.8em;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 8px;
            }

            .header {
                padding: 32px 16px;
            }

            .header h1 {
                font-size: 1.6em;
            }

            .controls {
                padding: 12px;
            }

            .tab-content {
                padding: 20px 16px;
            }

            .grade-entry-table {
                font-size: 0.8em;
            }
        }

        .decimal-select {
            width: 100%;
            padding: 14px 20px;
            border: 2px solid var(--border);
            border-radius: 50px;
            font-family: var(--font-sans);
            font-size: 1em;
            background: rgba(255, 255, 255, 0.6);
            color: var(--fg);
            transition: all 0.3s ease;
        }

        .decimal-select:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 3px rgba(93, 112, 82, 0.1);
        }

        .calculation-note {
            background: linear-gradient(135deg, rgba(93, 112, 82, 0.08) 0%, rgba(193, 140, 93, 0.08) 100%);
            padding: 20px;
            border-radius: 24px;
            margin-top: 28px;
            color: var(--fg);
            font-size: 0.95em;
            border-left: 4px solid var(--primary);
            border: 1px solid rgba(222, 216, 207, 0.4);
            line-height: 1.7;
        }

        .calculation-note strong {
            color: var(--primary);
            display: block;
            margin-bottom: 8px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(44, 44, 36, 0.4);
            backdrop-filter: blur(4px);
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: var(--bg);
            margin: 10% auto;
            padding: 40px;
            border-radius: 32px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(93, 112, 82, 0.15);
            border: 1px solid rgba(222, 216, 207, 0.4);
        }

        .modal-header {
            font-family: var(--font-serif);
            font-size: 1.6em;
            font-weight: 700;
            margin-bottom: 24px;
            color: var(--fg);
        }

        .modal-input {
            width: 100%;
            padding: 14px 20px;
            border: 2px solid var(--border);
            border-radius: 50px;
            font-family: var(--font-sans);
            font-size: 1em;
            margin-bottom: 24px;
            background: rgba(255, 255, 255, 0.6);
            color: var(--fg);
            transition: all 0.3s ease;
        }

        .modal-input:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 3px rgba(93, 112, 82, 0.1);
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .modal-buttons button {
            padding: 12px 28px;
            font-size: 0.95em;
            margin: 0;
        }

        .close-modal {
            background: var(--muted);
            color: var(--fg);
            border-color: var(--border);
        }

        .close-modal:hover {
            background: var(--border);
            box-shadow: var(--shadow-soft);
        }

        .save-list {
            list-style: none;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid rgba(222, 216, 207, 0.4);
            border-radius: 24px;
            margin: 20px 0;
            background: white;
        }

        .save-list li {
            padding: 16px 20px;
            border-bottom: 1px solid rgba(222, 216, 207, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .save-list li:hover {
            background: rgba(93, 112, 82, 0.03);
        }

        .save-list li:last-child {
            border-bottom: none;
        }

        .save-buttons {
            display: flex;
            gap: 8px;
        }

        .save-buttons button {
            padding: 8px 16px;
            font-size: 0.85em;
            margin: 0;
        }

        .delete-btn {
            background: var(--destructive);
            border-color: var(--destructive);
        }

        .delete-btn:hover {
            box-shadow: 0 6px 24px -4px rgba(168, 84, 72, 0.25);
        }

        .load-btn {
            background: var(--secondary);
            border-color: var(--secondary);
        }

        .load-btn:hover {
            box-shadow: 0 6px 24px -4px rgba(193, 140, 93, 0.25);
        }

        .success-message {
            background: linear-gradient(135deg, rgba(93, 112, 82, 0.1) 0%, rgba(212, 237, 218, 0.5) 100%);
            color: var(--primary);
            padding: 16px 20px;
            border-radius: 24px;
            margin-bottom: 16px;
            border-left: 4px solid var(--primary);
            border: 1px solid rgba(93, 112, 82, 0.2);
            line-height: 1.6;
            font-weight: 500;
        }

        .error-message {
            background: linear-gradient(135deg, rgba(168, 84, 72, 0.1) 0%, rgba(248, 215, 218, 0.5) 100%);
            color: var(--destructive);
            padding: 16px 20px;
            border-radius: 24px;
            margin-bottom: 16px;
            border-left: 4px solid var(--destructive);
            border: 1px solid rgba(168, 84, 72, 0.2);
            line-height: 1.6;
            font-weight: 500;
        }

        /* Toggle Switch */
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 24px;
            padding: 16px 20px;
            background: linear-gradient(135deg, rgba(93, 112, 82, 0.05) 0%, rgba(193, 140, 93, 0.05) 100%);
            border-radius: 24px;
            border: 1px solid rgba(222, 216, 207, 0.3);
        }

        .toggle-label {
            font-weight: 600;
            color: var(--fg);
            font-size: 0.95em;
        }

        .toggle-switch {
            position: relative;
            display: inline-flex;
            width: 52px;
            height: 28px;
            background: var(--border);
            border-radius: 14px;
            cursor: pointer;
            transition: background 0.3s ease;
            border: 2px solid var(--border);
        }

        .toggle-switch input {
            display: none;
        }

        .toggle-switch input:checked + .toggle-slider {
            transform: translateX(24px);
            background: var(--primary);
        }

        .toggle-switch input:checked ~ .toggle-switch-bg {
            background: var(--primary);
        }

        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
            z-index: 2;
        }

        .toggle-switch-bg {
            position: absolute;
            inset: 0;
            background: var(--border);
            border-radius: 12px;
            transition: background 0.3s ease;
            z-index: 1;
        }

        .toggle-switch.active {
            background: var(--primary);
        }

        .toggle-switch.active .toggle-slider {
            background: white;
            transform: translateX(24px);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>üìä Grade Calculator</h1>
                <p>Calculate your grades with ease and grace</p>
            </div>
        </div>

        <div class="controls">
            <button onclick="saveCalculation()">üíæ Save Current</button>
            <button onclick="openSaveManager()">üìÅ Manage Saves</button>
            <button onclick="openNewTab()">üìÑ Open New Tab</button>
        </div>

        <div class="tab-container">
            <button class="tab-button active" onclick="switchTab('grade-calc')">Grade Calculator</button>
            <button class="tab-button" onclick="switchTab('final-grade-calc')">Final Grade Calculator</button>
            <button class="tab-button" onclick="switchTab('gpa-calc')">GPA Calculator</button>
        </div>

        <!-- Grade Calculator Tab -->
        <div id="grade-calc" class="tab-content active">
            <h2>Grade Calculator</h2>
            <p>Calculate your weighted average grade</p>

            <div class="form-group">
                <label>Select decimal places for result:</label>
                <select id="decimalPlaces" class="decimal-select" onchange="calculateGrade()">
                    <option value="1">1 decimal place</option>
                    <option value="2" selected>2 decimal places</option>
                    <option value="3">3 decimal places</option>
                    <option value="4">4 decimal places</option>
                </select>
            </div>

            <button class="add-row-btn" onclick="addGradeRow()">+ Add Assignment</button>

            <table class="grade-entry-table">
                <thead>
                    <tr>
                        <th>Assignment Type</th>
                        <th>Grade (%)</th>
                        <th>Weight (%)</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="gradeTableBody">
                    <tr class="grade-row">
                        <td><input type="text" placeholder="e.g Assignment" class="assignment-name" value="Assignment"></td>
                        <td><input type="number" step="0.1" min="0" max="100" placeholder="100" class="grade-value" value="100" onchange="calculateGrade()"></td>
                        <td><input type="number" step="0.1" min="0" placeholder="10" class="grade-weight" value="10" onchange="calculateGrade()"></td>
                        <td><button onclick="removeGradeRow(this)">Remove</button></td>
                    </tr>
                    <tr class="grade-row">
                        <td><input type="text" placeholder="e.g Homework" class="assignment-name" value="Homework"></td>
                        <td><input type="number" step="0.1" min="0" max="100" placeholder="100" class="grade-value" value="92.5" onchange="calculateGrade()"></td>
                        <td><input type="number" step="0.1" min="0" placeholder="10" class="grade-weight" value="10" onchange="calculateGrade()"></td>
                        <td><button onclick="removeGradeRow(this)">Remove</button></td>
                    </tr>
                    <tr class="grade-row">
                        <td><input type="text" placeholder="e.g Exam" class="assignment-name" value="Exam"></td>
                        <td><input type="number" step="0.1" min="0" max="100" placeholder="100" class="grade-value" value="88" onchange="calculateGrade()"></td>
                        <td><input type="number" step="0.1" min="0" placeholder="10" class="grade-weight" value="25" onchange="calculateGrade()"></td>
                        <td><button onclick="removeGradeRow(this)">Remove</button></td>
                    </tr>
                </tbody>
            </table>

            <div class="grid-2">
                <div class="form-group">
                    <label>Find additional grade needed to get average of (%):</label>
                    <input type="number" id="targetAverage" step="0.1" min="0" max="100" placeholder="80" value="80">
                </div>
                <button onclick="calculateAdditionalGrade()" style="align-self: flex-end; margin-bottom: 0; padding: 15px;">Calculate Additional Grade</button>
            </div>

            <div class="results" id="gradeResults" style="display: none;">
                <div class="result-item">
                    <span class="result-label">Average Grade:</span>
                    <span class="result-value" id="averageGrade">0.00%</span>
                </div>
                <div id="additionalGradeResult"></div>
            </div>

            <div class="calculation-note">
                <strong>How it works:</strong> Weighted Grade = (w‚ÇÅ√óg‚ÇÅ + w‚ÇÇ√óg‚ÇÇ + ... w‚Çô√óg‚Çô) / (w‚ÇÅ + w‚ÇÇ + ... w‚Çô)
            </div>
        </div>

        <!-- Final Grade Calculator Tab -->
        <div id="final-grade-calc" class="tab-content">
            <h2>Final Grade Calculator</h2>
            <p>Calculate the grade needed on your final exam</p>

            <div class="toggle-container">
                <span class="toggle-label">Live Updates</span>
                <label class="toggle-switch" id="liveUpdateToggle">
                    <input type="checkbox" id="liveUpdateToggleInput" onchange="toggleLiveUpdates()">
                    <span class="toggle-slider"></span>
                    <div class="toggle-switch-bg"></div>
                </label>
            </div>

            <div class="grid-2">
                <div class="form-group">
                    <label>Current Grade (%):</label>
                    <input type="number" id="currentGrade" step="0.1" min="0" max="100" placeholder="0" value="0" onchange="handleFinalGradeChange()">
                </div>
                <div class="form-group">
                    <label>Target Grade (%):</label>
                    <input type="number" id="targetGrade" step="0.1" min="0" max="100" placeholder="0" value="80" onchange="handleFinalGradeChange()">
                </div>
            </div>

            <div class="form-group">
                <label>Current Grade Weight (%):</label>
                <input type="number" id="currentGradeWeight" step="0.1" min="0" max="100" placeholder="0" value="80" onchange="handleFinalGradeChange()">
            </div>

            <div class="form-group">
                <label>Final Exam Weight (%):</label>
                <input type="number" id="finalExamWeight" step="0.1" min="0" max="100" placeholder="0" value="20" onchange="handleFinalGradeChange()">
            </div>

            <button id="calculateFinalBtn" onclick="calculateFinalGradeNeeded()" style="width: 100%; padding: 14px; font-size: 1.05em;">Calculate Final Exam Grade Needed</button>

            <div class="results" id="finalGradeResults" style="display: none;">
                <div class="result-item">
                    <span class="result-label">Final Exam Grade Needed:</span>
                    <span class="result-value" id="finalGradeNeeded">0.00%</span>
                </div>
                <div id="finalGradeNote" style="margin-top: 12px; font-size: 0.95em; color: var(--muted-fg);"></div>
            </div>

            <div class="calculation-note">
                <strong>Formula:</strong> Final Grade Needed = (Target Grade - Current Grade √ó Current Weight%) / Final Exam Weight%
            </div>
        </div>

        <!-- GPA Calculator Tab -->
        <div id="gpa-calc" class="tab-content">
            <h2>GPA Calculator</h2>
            <p>Calculate your weighted GPA</p>

            <div class="form-group">
                <label>Select decimal places for result:</label>
                <select id="gpaDecimalPlaces" class="decimal-select" onchange="calculateGPA()">
                    <option value="1">1 decimal place</option>
                    <option value="2" selected>2 decimal places</option>
                    <option value="3">3 decimal places</option>
                    <option value="4">4 decimal places</option>
                </select>
            </div>

            <button class="add-row-btn" onclick="addGPARow()">+ Add Course</button>

            <table class="grade-entry-table">
                <thead>
                    <tr>
                        <th>Course Name</th>
                        <th>Grade (%)</th>
                        <th>Weight (Credits/Hours)</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="gpaTableBody">
                    <tr class="gpa-row">
                        <td><input type="text" placeholder="e.g Math" class="course-name" value="Math"></td>
                        <td><input type="number" step="0.1" min="0" max="100" placeholder="85" class="gpa-grade" value="85" onchange="calculateGPA()"></td>
                        <td><input type="number" step="0.1" min="0" placeholder="3" class="gpa-weight" value="3" onchange="calculateGPA()"></td>
                        <td><button onclick="removeGPARow(this)">Remove</button></td>
                    </tr>
                    <tr class="gpa-row">
                        <td><input type="text" placeholder="e.g English" class="course-name" value="English"></td>
                        <td><input type="number" step="0.1" min="0" max="100" placeholder="90" class="gpa-grade" value="90" onchange="calculateGPA()"></td>
                        <td><input type="number" step="0.1" min="0" placeholder="3" class="gpa-weight" value="3" onchange="calculateGPA()"></td>
                        <td><button onclick="removeGPARow(this)">Remove</button></td>
                    </tr>
                    <tr class="gpa-row">
                        <td><input type="text" placeholder="e.g Science" class="course-name" value="Science"></td>
                        <td><input type="number" step="0.1" min="0" max="100" placeholder="88" class="gpa-grade" value="88" onchange="calculateGPA()"></td>
                        <td><input type="number" step="0.1" min="0" placeholder="4" class="gpa-weight" value="4" onchange="calculateGPA()"></td>
                        <td><button onclick="removeGPARow(this)">Remove</button></td>
                    </tr>
                </tbody>
            </table>

            <div class="results" id="gpaResults" style="display: none;">
                <div class="result-item">
                    <span class="result-label">Weighted GPA (Percentage):</span>
                    <span class="result-value" id="weightedGPA">0.00%</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Total Credits/Hours:</span>
                    <span class="result-value" id="totalCredits">0</span>
                </div>
            </div>

            <div class="calculation-note">
                <strong>Formula:</strong> Weighted GPA = (w‚ÇÅ√óg‚ÇÅ + w‚ÇÇ√óg‚ÇÇ + ... w‚Çô√óg‚Çô) / (w‚ÇÅ + w‚ÇÇ + ... w‚Çô)
            </div>
        </div>
    </div>

    <!-- Save Manager Modal -->
    <div id="saveModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">Manage Saved Calculations</div>
            <div id="saveMessage"></div>
            <ul id="saveList" class="save-list"></ul>
            <button onclick="closeSaveModal()" class="close-modal" style="width: 100%; margin-top: 15px;">Close</button>
        </div>
    </div>

    <!-- Save Name Modal -->
    <div id="saveNameModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">Save Calculation</div>
            <p style="margin-bottom: 20px; color: var(--muted-fg); font-size: 0.95em;">Enter a name for this calculation:</p>
            <input type="text" id="saveName" class="modal-input" placeholder="e.g. Fall 2024 Semester">
            <div class="modal-buttons">
                <button onclick="closeSaveNameModal()" class="close-modal">Cancel</button>
                <button onclick="confirmSave()">Save</button>
            </div>
        </div>
    </div>

    <script>
        let currentTab = 'grade-calc';
        let saveToDelete = null;

        // Tab switching
        function switchTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Deactivate all tab buttons
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));

            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            currentTab = tabName;
        }

        // Grade Calculator Functions
        function addGradeRow() {
            const tbody = document.getElementById('gradeTableBody');
            const row = document.createElement('tr');
            row.className = 'grade-row';
            row.innerHTML = `
                <td><input type="text" placeholder="e.g Assignment" class="assignment-name"></td>
                <td><input type="number" step="0.1" min="0" max="100" placeholder="100" class="grade-value" onchange="calculateGrade()"></td>
                <td><input type="number" step="0.1" min="0" placeholder="10" class="grade-weight" onchange="calculateGrade()"></td>
                <td><button onclick="removeGradeRow(this)">Remove</button></td>
            `;
            tbody.appendChild(row);
        }

        function removeGradeRow(btn) {
            btn.closest('tr').remove();
            calculateGrade();
        }

        function calculateGrade() {
            const rows = document.querySelectorAll('.grade-row');
            let totalWeighted = 0;
            let totalWeight = 0;
            let hasData = false;

            rows.forEach(row => {
                const grade = parseFloat(row.querySelector('.grade-value').value) || 0;
                const weight = parseFloat(row.querySelector('.grade-weight').value) || 0;

                if (grade > 0 && weight > 0) {
                    hasData = true;
                    totalWeighted += grade * weight;
                    totalWeight += weight;
                }
            });

            const resultsDiv = document.getElementById('gradeResults');
            if (hasData && totalWeight > 0) {
                const average = totalWeighted / totalWeight;
                const decimals = parseInt(document.getElementById('decimalPlaces').value);
                document.getElementById('averageGrade').textContent = average.toFixed(decimals) + '%';
                resultsDiv.style.display = 'block';
            } else {
                resultsDiv.style.display = 'none';
            }
        }

        function calculateAdditionalGrade() {
            const targetAvg = parseFloat(document.getElementById('targetAverage').value) || 0;
            const rows = document.querySelectorAll('.grade-row');
            let totalWeighted = 0;
            let totalWeight = 0;

            rows.forEach(row => {
                const grade = parseFloat(row.querySelector('.grade-value').value) || 0;
                const weight = parseFloat(row.querySelector('.grade-weight').value) || 0;

                if (grade > 0 && weight > 0) {
                    totalWeighted += grade * weight;
                    totalWeight += weight;
                }
            });

            const currentAvg = totalWeight > 0 ? totalWeighted / totalWeight : 0;

            if (currentAvg >= targetAvg) {
                document.getElementById('additionalGradeResult').innerHTML = `
                    <div class="success-message" style="margin-top: 15px;">
                        ‚úì Great job! Your average is already ${currentAvg.toFixed(2)}%, which is above your target of ${targetAvg}%.
                    </div>
                `;
            } else {
                document.getElementById('additionalGradeResult').innerHTML = `
                    <div class="result-item" style="margin-top: 15px;">
                        <span class="result-label">Grade needed to reach ${targetAvg}%:</span>
                        <span class="result-value">${(targetAvg * totalWeight - totalWeighted).toFixed(2)}% (weighted)</span>
                    </div>
                `;
            }
        }

        // Final Grade Calculator Functions
        let liveUpdatesEnabled = false;

        function toggleLiveUpdates() {
            liveUpdatesEnabled = document.getElementById('liveUpdateToggleInput').checked;
            const toggleElement = document.getElementById('liveUpdateToggle');
            
            if (liveUpdatesEnabled) {
                toggleElement.classList.add('active');
            } else {
                toggleElement.classList.remove('active');
            }
        }

        function handleFinalGradeChange() {
            if (liveUpdatesEnabled) {
                calculateFinalGradeNeeded();
            }
        }

        function calculateFinalGradeNeeded() {
            const currentGrade = parseFloat(document.getElementById('currentGrade').value) || 0;
            const targetGrade = parseFloat(document.getElementById('targetGrade').value) || 0;
            const currentWeight = parseFloat(document.getElementById('currentGradeWeight').value) || 0;
            const finalWeight = parseFloat(document.getElementById('finalExamWeight').value) || 0;

            if (currentWeight + finalWeight !== 100) {
                document.getElementById('finalGradeNote').innerHTML = `
                    <div class="error-message">
                        ‚ö† Warning: Current weight + Final exam weight should equal 100% (Currently: ${currentWeight + finalWeight}%)
                    </div>
                `;
                return;
            }

            let finalGradeNeeded;
            if (finalWeight === 0) {
                finalGradeNeeded = currentGrade;
            } else {
                finalGradeNeeded = (targetGrade - currentGrade * (currentWeight / 100)) / (finalWeight / 100);
            }

            const resultsDiv = document.getElementById('finalGradeResults');
            if (finalGradeNeeded > 100) {
                document.getElementById('finalGradeNote').innerHTML = `
                    <div class="error-message">
                        ‚úó Impossible: You would need ${finalGradeNeeded.toFixed(2)}% on the final exam, which exceeds 100%.
                    </div>
                `;
            } else if (finalGradeNeeded < 0) {
                document.getElementById('finalGradeNote').innerHTML = `
                    <div class="success-message">
                        ‚úì You can score 0% on the final exam and still achieve your target grade!
                    </div>
                `;
                document.getElementById('finalGradeNeeded').textContent = '0.00%';
            } else {
                document.getElementById('finalGradeNeeded').textContent = finalGradeNeeded.toFixed(2) + '%';
                document.getElementById('finalGradeNote').innerHTML = `
                    <p>You need to score <strong>${finalGradeNeeded.toFixed(2)}%</strong> on the final exam to reach your target grade of <strong>${targetGrade}%</strong>.</p>
                `;
            }
            resultsDiv.style.display = 'block';
        }

        // GPA Calculator Functions
        function addGPARow() {
            const tbody = document.getElementById('gpaTableBody');
            const row = document.createElement('tr');
            row.className = 'gpa-row';
            row.innerHTML = `
                <td><input type="text" placeholder="e.g Course" class="course-name"></td>
                <td><input type="number" step="0.1" min="0" max="100" placeholder="85" class="gpa-grade" onchange="calculateGPA()"></td>
                <td><input type="number" step="0.1" min="0" placeholder="3" class="gpa-weight" onchange="calculateGPA()"></td>
                <td><button onclick="removeGPARow(this)">Remove</button></td>
            `;
            tbody.appendChild(row);
        }

        function removeGPARow(btn) {
            btn.closest('tr').remove();
            calculateGPA();
        }

        function calculateGPA() {
            const rows = document.querySelectorAll('.gpa-row');
            let totalWeighted = 0;
            let totalWeight = 0;
            let hasData = false;

            rows.forEach(row => {
                const grade = parseFloat(row.querySelector('.gpa-grade').value) || 0;
                const weight = parseFloat(row.querySelector('.gpa-weight').value) || 0;

                if (grade > 0 && weight > 0) {
                    hasData = true;
                    totalWeighted += grade * weight;
                    totalWeight += weight;
                }
            });

            const resultsDiv = document.getElementById('gpaResults');
            if (hasData && totalWeight > 0) {
                const gpa = totalWeighted / totalWeight;
                const decimals = parseInt(document.getElementById('gpaDecimalPlaces').value);
                document.getElementById('weightedGPA').textContent = gpa.toFixed(decimals) + '%';
                document.getElementById('totalCredits').textContent = totalWeight.toFixed(2);
                resultsDiv.style.display = 'block';
            } else {
                resultsDiv.style.display = 'none';
            }
        }

        // Save and Load Functions
        function getCalculationData() {
            const tab = currentTab;
            let data = { tab, timestamp: new Date().toLocaleString() };

            if (tab === 'grade-calc') {
                const rows = document.querySelectorAll('.grade-row');
                data.grades = [];
                rows.forEach(row => {
                    data.grades.push({
                        name: row.querySelector('.assignment-name').value,
                        grade: row.querySelector('.grade-value').value,
                        weight: row.querySelector('.grade-weight').value
                    });
                });
                data.targetAverage = document.getElementById('targetAverage').value;
                data.decimalPlaces = document.getElementById('decimalPlaces').value;
            } else if (tab === 'final-grade-calc') {
                data.currentGrade = document.getElementById('currentGrade').value;
                data.targetGrade = document.getElementById('targetGrade').value;
                data.currentGradeWeight = document.getElementById('currentGradeWeight').value;
                data.finalExamWeight = document.getElementById('finalExamWeight').value;
            } else if (tab === 'gpa-calc') {
                const rows = document.querySelectorAll('.gpa-row');
                data.courses = [];
                rows.forEach(row => {
                    data.courses.push({
                        name: row.querySelector('.course-name').value,
                        grade: row.querySelector('.gpa-grade').value,
                        weight: row.querySelector('.gpa-weight').value
                    });
                });
                data.decimalPlaces = document.getElementById('gpaDecimalPlaces').value;
            }

            return data;
        }

        function saveCalculation() {
            document.getElementById('saveNameModal').style.display = 'block';
        }

        function confirmSave() {
            const name = document.getElementById('saveName').value.trim();
            if (!name) {
                alert('Please enter a name for this calculation');
                return;
            }

            const data = getCalculationData();
            let saves = JSON.parse(localStorage.getItem('gradeCalculatorSaves')) || {};
            saves[name] = data;
            localStorage.setItem('gradeCalculatorSaves', JSON.stringify(saves));

            document.getElementById('saveName').value = '';
            closeSaveNameModal();

            alert(`‚úì Calculation saved as "${name}"`);
        }

        function openSaveManager() {
            const saves = JSON.parse(localStorage.getItem('gradeCalculatorSaves')) || {};
            const saveList = document.getElementById('saveList');
            saveList.innerHTML = '';

            if (Object.keys(saves).length === 0) {
                document.getElementById('saveMessage').innerHTML = '<div class="error-message">No saved calculations yet.</div>';
                saveList.innerHTML = '';
            } else {
                document.getElementById('saveMessage').innerHTML = '';
                Object.keys(saves).forEach(name => {
                    const data = saves[name];
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <div>
                            <strong>${name}</strong>
                            <div style="font-size: 0.85em; color: #999; margin-top: 3px;">
                                ${data.tab.replace(/-/g, ' ').toUpperCase()} | ${data.timestamp}
                            </div>
                        </div>
                        <div class="save-buttons">
                            <button class="load-btn" onclick="loadCalculation('${name}')">Load</button>
                            <button class="delete-btn" onclick="deleteCalculation('${name}')">Delete</button>
                        </div>
                    `;
                    saveList.appendChild(li);
                });
            }

            document.getElementById('saveModal').style.display = 'block';
        }

        function loadCalculation(name) {
            const saves = JSON.parse(localStorage.getItem('gradeCalculatorSaves')) || {};
            const data = saves[name];

            if (!data) return;

            // Switch to correct tab
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(data.tab).classList.add('active');
            document.querySelector(`button[onclick="switchTab('${data.tab}')"]`).classList.add('active');
            currentTab = data.tab;

            if (data.tab === 'grade-calc') {
                const tbody = document.getElementById('gradeTableBody');
                tbody.innerHTML = '';
                data.grades.forEach(grade => {
                    const row = document.createElement('tr');
                    row.className = 'grade-row';
                    row.innerHTML = `
                        <td><input type="text" placeholder="e.g Assignment" class="assignment-name" value="${grade.name}"></td>
                        <td><input type="number" step="0.1" min="0" max="100" placeholder="100" class="grade-value" value="${grade.grade}" onchange="calculateGrade()"></td>
                        <td><input type="number" step="0.1" min="0" placeholder="10" class="grade-weight" value="${grade.weight}" onchange="calculateGrade()"></td>
                        <td><button onclick="removeGradeRow(this)">Remove</button></td>
                    `;
                    tbody.appendChild(row);
                });
                document.getElementById('targetAverage').value = data.targetAverage;
                document.getElementById('decimalPlaces').value = data.decimalPlaces;
                calculateGrade();
            } else if (data.tab === 'final-grade-calc') {
                document.getElementById('currentGrade').value = data.currentGrade;
                document.getElementById('targetGrade').value = data.targetGrade;
                document.getElementById('currentGradeWeight').value = data.currentGradeWeight;
                document.getElementById('finalExamWeight').value = data.finalExamWeight;
                calculateFinalGradeNeeded();
            } else if (data.tab === 'gpa-calc') {
                const tbody = document.getElementById('gpaTableBody');
                tbody.innerHTML = '';
                data.courses.forEach(course => {
                    const row = document.createElement('tr');
                    row.className = 'gpa-row';
                    row.innerHTML = `
                        <td><input type="text" placeholder="e.g Course" class="course-name" value="${course.name}"></td>
                        <td><input type="number" step="0.1" min="0" max="100" placeholder="85" class="gpa-grade" value="${course.grade}" onchange="calculateGPA()"></td>
                        <td><input type="number" step="0.1" min="0" placeholder="3" class="gpa-weight" value="${course.weight}" onchange="calculateGPA()"></td>
                        <td><button onclick="removeGPARow(this)">Remove</button></td>
                    `;
                    tbody.appendChild(row);
                });
                document.getElementById('gpaDecimalPlaces').value = data.decimalPlaces;
                calculateGPA();
            }

            closeSaveModal();
            alert(`‚úì Calculation "${name}" loaded!`);
        }

        function deleteCalculation(name) {
            if (confirm(`Delete calculation "${name}"?`)) {
                let saves = JSON.parse(localStorage.getItem('gradeCalculatorSaves')) || {};
                delete saves[name];
                localStorage.setItem('gradeCalculatorSaves', JSON.stringify(saves));
                openSaveManager();
                alert(`‚úì Calculation deleted!`);
            }
        }

        function openNewTab() {
            window.open(window.location.href, '_blank');
        }

        function closeSaveModal() {
            document.getElementById('saveModal').style.display = 'none';
        }

        function closeSaveNameModal() {
            document.getElementById('saveNameModal').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            let modal = document.getElementById('saveModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
            modal = document.getElementById('saveNameModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }

        // Initialize
        calculateGrade();
    </script>
</body>
</html>
